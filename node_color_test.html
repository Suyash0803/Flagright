<!DOCTYPE html>
<html>
<head>
    <title>Node Color Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .pass { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .fail { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>
    <h1>üîç Fraud Detection - Node Color Verification</h1>
    <div id="results"></div>
    
    <script>
        async function testNodeColors() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Testing...</p>';
            
            try {
                // Test the relationships API
                const response = await fetch('http://localhost:5000/api/relationships/user/user-1');
                const data = await response.json();
                
                let html = '<h2>üß™ API Test Results</h2>';
                
                // Count node types
                const transactionNodes = data.nodes.filter(n => n.data.type === 'transaction');
                const userNodes = data.nodes.filter(n => n.data.type === 'user');
                
                // Test 1: Transaction nodes have correct type
                if (transactionNodes.length > 0) {
                    html += '<div class="test-result pass">‚úÖ PASS: Found ' + transactionNodes.length + ' transaction nodes with type="transaction"</div>';
                } else {
                    html += '<div class="test-result fail">‚ùå FAIL: No transaction nodes found with type="transaction"</div>';
                }
                
                // Test 2: User nodes have correct type
                if (userNodes.length > 0) {
                    html += '<div class="test-result pass">‚úÖ PASS: Found ' + userNodes.length + ' user nodes with type="user"</div>';
                } else {
                    html += '<div class="test-result fail">‚ùå FAIL: No user nodes found with type="user"</div>';
                }
                
                // Test 3: Sample data verification
                html += '<h3>üîµ Sample Transaction Nodes (Should be BLUE in frontend):</h3><ul>';
                transactionNodes.slice(0, 5).forEach(node => {
                    html += `<li style="color: blue; font-weight: bold;">ID: ${node.data.id} | Type: ${node.data.type} | Label: ${node.data.label}</li>`;
                });
                html += '</ul>';
                
                html += '<h3>üü¢ Sample User Nodes (Should be GREEN in frontend):</h3><ul>';
                userNodes.slice(0, 5).forEach(node => {
                    html += `<li style="color: green; font-weight: bold;">ID: ${node.data.id} | Type: ${node.data.type} | Label: ${node.data.label}</li>`;
                });
                html += '</ul>';
                
                html += '<div class="test-result pass"><strong>‚úÖ SUCCESS: Backend is now returning correct node types!</strong><br>';
                html += 'Transaction nodes should appear as BLUE circles in the main application.<br>';
                html += 'User nodes should appear as GREEN circles in the main application.</div>';
                
                html += '<h3>üìã Instructions:</h3>';
                html += '<ol>';
                html += '<li>Go to <a href="http://localhost:3000" target="_blank">http://localhost:3000</a></li>';
                html += '<li>Switch to "Users" view if not already there</li>';
                html += '<li>Click on any user name from the list</li>';
                html += '<li>Look at the graph visualization - transaction nodes should now be BLUE!</li>';
                html += '</ol>';
                
                results.innerHTML = html;
                
            } catch (error) {
                results.innerHTML = '<div class="test-result fail">‚ùå ERROR: ' + error.message + '</div>';
            }
        }
        
        // Run test on page load
        testNodeColors();
    </script>
</body>
</html>